#
# Makefile for Nut shell
#
# Maintain the following definitions:
#
#	HDR	all header files (*.h) that you create
#	HDRg	all header files generated by programs (eg, lex and yacc)
#	SRC	all C source files (*.c) that you create
#	SRCg	all C source files generated by programs
#	OBJ	all object files (*.o) required to load your program
#
# Use the following make targets:
#
#	all	(or nothing) to build your program (into a.out)
#	depend	to update header file dependencies
#	listall	to list your complete program
#	list	to list files changed since the last listing
#	lint	to check your program with lint

HDR =  nutty.h init.h funcs.h
HDRg = y.tab.h
SRC =  main.c support.c 
SRCg = lex.yy.c y.tab.c
OBJ =  main.o lex.yy.o y.tab.o support.o 
DEP = ${SRC} ${SRCg}
CFLAGS = -g

nut: ${OBJ}
	cc -o nut ${CFLAGS} ${OBJ} -ll

lint:
	lint -hxn ${DEP}

clean:
	rm -f ${HDRg} ${SRCg} ${OBJ}

lex.yy.c: nut.l info.h
	lex nut.l 

y.tab.c: nut.y   
	yacc -dvt -d nut.y 
	-(cmp -s y.tab.h info.h || cp y.tab.h info.h)

info.h: y.tab.c

main.o: info.h init.h funcs.h
support.o: nutty.h funcs.h
lex.yy.o: stdio.h info.h
y.tab.o: nutty.h funcs.h
